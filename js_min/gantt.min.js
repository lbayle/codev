function setGanttOptions(){gantt.config.start_date=new Date(ganttPageSmartyData.windowStartDate);gantt.config.date_grid="%Y-%m-%d";gantt.config.readonly=true;gantt.config.row_height=22;gantt.config.date_scale="%d/%m";gantt.config.subscales=[{unit:"month",step:1,date:"%F %Y"}];gantt.config.xml_date="%d-%m-%Y %H:%i";gantt.templates.scale_cell_class=function(date){if(date.getDay()==0||date.getDay()==6){return"weekend"}};gantt.templates.task_cell_class=function(item,date){if(date.getDay()==0||date.getDay()==6){return"weekend"}};gantt.templates.tooltip_text=function(start,end,task){return task.tooltipHtml};gantt.templates.task_text=function(start,end,task){return task.barText};gantt.templates.rightside_text=function(start,end,task){return task.assignedTo};gantt.config.columns=[{name:"text",label:"Task",width:"*",tree:true},{name:"start_date",label:"Start",align:"center"},{name:"end_date",label:"End",template:function(obj){return obj.end_date_real}},{name:"duration",label:"Backlog",align:"center",template:function(obj){return obj.duration_real}}];gantt.attachEvent("onBeforeTaskDisplay",function(id,task){var summaryFilter=$("#summaryFilter").val();if(task.text.toString().toLowerCase().indexOf(summaryFilter)>=0){return true}if(task.summary.toString().toLowerCase().indexOf(summaryFilter)>=0){return true}if(task.assignedTo.toString().toLowerCase().indexOf(summaryFilter)>=0){return true}return false})}function computeGantt(redirect){if(null===redirect){redirect=false}if(redirect){window.location.hash="#tabGantt_gantt"}$("#loading").show();var jsonGanttTasksPromise=$.ajax({url:ganttPageSmartyData.ajaxPage,data:{action:"getGanttTasks"},type:"post",dataType:"json",success:function(data){if("SUCCESS"===data.statusMsg){jsonGanttTasks=data.ganttTasks;gantt.config.end_date=new Date(data.ganttEndDate)}else{$("#loading").hide();console.error("Ajax statusMsg",data.statusMsg);alert(data.statusMsg)}},error:function(jqXHR,textStatus,errorThrown){$("#loading").hide();console.error(textStatus,errorThrown);alert("ERROR: Please contact your CodevTT administrator")}});$.when(jsonGanttTasksPromise).done(function(){gantt.parse(jsonGanttTasks);console.log("number of tasks currently loaded in the gantt",gantt.getTaskCount());console.log("number of tasks visible on the screen (those that are not collapsed)",gantt.getVisibleTaskCount());$("#loading").hide()})}