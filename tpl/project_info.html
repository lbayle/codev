<div id="content">
   {if isset($projects)}
   <div class="center">
      <form name="projectForm" class="formWithTabsHistory" method="get" action="{$page}">
         <fieldset>
            {include file="form/projectSelector.html"}
            <input type="submit" value="{t}Jump{/t}" />
         </fieldset>
      </form>
   </div>
   {/if}
   {if isset($versionsOverview) || isset($versionsDetailedMgr) || isset($versionsDetailed) || isset($versionsIssues)}
   <h3>{t}Project Versions{/t}</h3>
   <script src="js/tabs.js" type="text/javascript"></script>
   <div id="tabsVersions" class="tabs">
      <ul>
         <li><a href="#tabVersionsDetailedMgr">{t}Detailed Mgr{/t}</a></li>
         <li><a href="#tabVersionsDetailed">{t}Detailed{/t}</a></li>
         <li><a href="#tabVersionsOverview">{t}Overview{/t}</a></li>
         <li><a href="#tabVersionsIssues">{t}Tasks{/t}</a></li>
      </ul>
      <div id="tabVersionsOverview">
         {if $versionsOverview}
         <table>
            <thead>
               <tr>
                  <th>{t}Target version{/t}</th>
                  <th>{t}Date{/t}</th>
                  <th style="width: 9em;">{t}Progress Mgr{/t}</th>
                  <th style="width: 9em;">{t}Progress{/t}</th>
                  <th style="width: 9em;">{t}Drift Mgr{/t}</th>
                  <th style="width: 9em;">{t}Drift{/t}</th>
               </tr>
            </thead>
            <tbody>
               {foreach from=$versionsOverview key=name item=i name=versionsOverview}
               {if $smarty.foreach.versionsOverview.last}
               <tr class="row_total">
                  <td>{t}Total{/t}</td>
                  <td></td>
                  <td><div class="progress">{$i.progressMgr}%</div></td>
                  <td><div class="progress">{$i.progress}%</div></td>
                  <td {if $i.driftMgrColor}style='background-color: #{$i.driftMgrColor};'{/if}>{$i.driftMgr}%</td>
                  <td {if $i.driftColor}style='background-color: #{$i.driftColor};'{/if}>{$i.drift}%</td>
               </tr>
               {else}
               <tr>
                  <td>{$i.name}</td>
                  <td>{$i.date}</td>
                  <td><div class="progress">{$i.progressMgr}%</div></td>
                  <td><div class="progress">{$i.progress}%</div></td>
                  <td {if $i.driftMgrColor}style='background-color: #{$i.driftMgrColor};'{/if}>{$i.driftMgr}%</td>
                  <td {if $i.driftColor}style='background-color: #{$i.driftColor};'{/if}>{$i.drift}%</td>
               </tr>
               {/if}
               {/foreach}
            </tbody>
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabVersionsDetailedMgr">
         {if $versionsDetailedMgr}
         <table>
            <thead>
               <tr>
                  <th>{t}Target version{/t}</th>
                  <th style="width: 9em;">{t}MgrEffortEstim{/t}</th>
                  <th style="width: 9em;" title="backlogMgr + elapsed">{t}Reestimated Mgr{/t}</th>
                  <th style="width: 9em;">{t}Elapsed{/t}</th>
                  <th style="width: 9em;">{t}Backlog Mgr{/t}</th>
                  <th style="width: 9em;">{t}Drift Mgr{/t}</th>
               </tr>
            </thead>
            <tbody>
               {foreach from=$versionsDetailedMgr key=name item=i name=versionsDetailedMgr}
               {if $smarty.foreach.versionsDetailedMgr.last}
               <tr class="row_total">
                  <td>{t}Total{/t}</td>
                  <td>{$i.effortEstim}</td>
                  <td>{$i.reestimated}</td>
                  <td>{$i.elapsed}</td>
                  <td>{$i.backlog}</td>
                  <td {if isset($i.driftColor)}style='background-color: #{$i.driftColor};'{/if} title="{t}nb days{/t}">{$i.drift}</td>
               </tr>
               {else}
               <tr>
                  <td>{$i.name}</td>
                  <td>{$i.effortEstim}</td>
                  <td>{$i.reestimated}</td>
                  <td>{$i.elapsed}</td>
                  <td>{$i.backlog}</td>
                  <td {if $i.driftColor}style='background-color: #{$i.driftColor};'{/if} title="{t}nb days{/t}">{$i.drift}</td>
               </tr>
               {/if}
               {/foreach}
            </tbody>
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabVersionsDetailed">
         {if $versionsDetailed}
         <table>
            <thead>
               <tr>
                  <th>{t}Target version{/t}</th>
                  <th style="width: 9em;">{t}EffortEstim{/t}</th>
                  <th style="width: 9em;">{t}Reestimated{/t}</th>
                  <th style="width: 9em;">{t}Elapsed{/t}</th>
                  <th style="width: 9em;">{t}Backlog{/t}</th>
                  <th style="width: 9em;">{t}Drift{/t}</th>
               </tr>
            </thead>
            <tbody>
               {foreach from=$versionsDetailed key=name item=i name=versionsDetailed}
               {if $smarty.foreach.versionsDetailed.last}
               <tr class="row_total">
                  <td>{t}Total{/t}</td>
                  <td>{$i.effortEstim}</td>
                  <td>{$i.reestimated}</td>
                  <td>{$i.elapsed}</td>
                  <td>{$i.backlog}</td>
                  <td title="{t}nb days{/t}">{$i.drift}</td>
               </tr>
               {else}
               <tr>
                  <td>{$i.name}</td>
                  <td title="{$i.title}">{$i.effortEstim}</td>
                  <td>{$i.reestimated}</td>
                  <td>{$i.elapsed}</td>
                  <td>{$i.backlog}</td>
                  <td {if $i.driftColor}style='background-color: #{$i.driftColor};'{/if} title="{t}nb days{/t}">{$i.drift}</td>
               </tr>
               {/if}
               {/foreach}
            </tbody>
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabVersionsIssues">
         {if $versionsIssues}
         <table>
            <thead>
               <tr>
                  <th>{t}Target version{/t}</th>
                  <th style="width: 33%;">{t}New Tasks{/t}</th>
                  <th style="width: 33%;">{t}Current Tasks{/t}</th>
                  <th style="width: 33%;">{t}Resolved Tasks{/t}</th>
               </tr>
            </thead>
            <tbody>
               {foreach from=$versionsIssues key=name item=i}
               <tr>
                  <td>{$i.name}</td>
                  <td>{$i.newList}</td>
                  <td>{$i.openList}</td>
                  <td>{$i.resolvedList}</td>
               </tr>
               {/foreach}
            </tbody>
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
   </div>
   {/if}
   {if isset($currentIssuesInDrift) || isset($resolvedIssuesInDrift)}
   <h3 style="margin-top: 2em">{t}Tasks in drift{/t}</h3>
   <div id="tabsDrift" class="tabs">
      <ul>
         <li><a href="#tabCurrentDrift">{t}Drift current tasks{/t}</a></li>
         <li><a href="#tabResolvedDrift">{t}Drift resolved tasks{/t}</a></li>
      </ul>
      <div id="tabCurrentDrift">
         {if $currentIssuesInDrift}
         <table>
            <!--<caption>{t}Tasks in drift{/t}</caption>-->
            <thead>
               <tr>
                  <th>{t}ID{/t}</th>
                  <th>{t}Project{/t}</th>
                  <th>{t}Target{/t}</th>
                  {if $isManager}<th title="{t}Drift relatively to the managers Estimation{/t}">{t}Drift Mgr{/t}</th>{/if}
                  <th title="{t}Drift relatively to (EE + AddEE){/t}">{t}Drift{/t}</th>
                  <th title="{t}Backlog{/t}">{t}BL{/t}</th>
                  <th>{t}Progress{/t}</th>
                  <th>{t}Status{/t}</th>
                  <th>{t}Summary{/t}</th>
               </tr>
            </thead>
            <tbody>
               {foreach from=$currentIssuesInDrift key=name item=i}
               <tr>
                  <td>{$i.mantisURL} {$i.issueURL}</td>
                  <td>{$i.projectName}</td>
                  <td>{$i.targetVersion}</td>
                  {if $isManager}<td style="width: 6em;{if $i.driftMgrColor}background-color: #{$i.driftMgrColor};{/if}">{$i.driftMgr}</td>{/if}
                  <td style="width: 6em;{if $i.driftColor}background-color: #{$i.driftColor};{/if}">{$i.drift}</td>
                  <td>{$i.backlog}</td>
                  <td>{$i.progress}%</td>
                  <td>{$i.currentStatusName}</td>
                  <td>{$i.summary}</td>
               </tr>
               {/foreach}
            </tbody>
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabResolvedDrift">
         {if $resolvedIssuesInDrift}
         <table>
            <!--<caption>{t}Tasks in drift{/t}</caption>-->
            <thead>
               <tr>
                  <th>{t}ID{/t}</th>
                  <th>{t}Project{/t}</th>
                  <th>{t}Target{/t}</th>
                  {if $isManager}<th style="width: 6em;" title="{t}Drift relatively to the managers Estimation{/t}">{t}Drift Mgr{/t}</th>{/if}
                  <th style="width: 6em;" title="{t}Drift relatively to (EE + AddEE){/t}">{t}Drift{/t}</th>
                  <th title="{t}Backlog{/t}">{t}BL{/t}</th>
                  <th>{t}Progress{/t}</th>
                  <th>{t}Status{/t}</th>
                  <th>{t}Summary{/t}</th>
               </tr>
            </thead>
            <tbody>
               {foreach from=$resolvedIssuesInDrift key=name item=i}
               <tr>
                  <td>{$i.mantisURL} {$i.issueURL}</td>
                  <td>{$i.projectName}</td>
                  <td>{$i.targetVersion}</td>
                  {if $isManager}<td {if $i.driftMgrColor}style='background-color: #{$i.driftMgrColor};'{/if}>{$i.driftMgr}</td>{/if}
                  <td {if $i.driftColor}style='background-color: #{$i.driftColor};'{/if}>{$i.drift}</td>
                  <td>{$i.backlog}</td>
                  <td>{$i.progress}%</td>
                  <td>{$i.currentStatusName}</td>
                  <td>{$i.summary}</td>
               </tr>
               {/foreach}
            </tbody>
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
   </div>
   {/if}
   {if isset($error)}
   <p class="center ui-state-error-text">{t}{$error}{/t}</p>
   {/if}
</div>
