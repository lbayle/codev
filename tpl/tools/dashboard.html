<div id="inettutsDashboard">
<!--
This file is associated to
- classes/Dashboard.class.php
- include/dashboard_ajax.php

TODO
- replace id by class (id="head", id="columns", id="column1", ...)
- dialogbox to add dashboardPluginCandidates
- form to save dashboard & plugins settings (call include/dashboard_ajax.php)

 when adding a plugin, a dialogbox should raise to set the plugin attributes.
 the content of this dialog is furnished by the plugin and loaded by ajax
-->
   


   <link href="lib/inettuts/inettuts_codevtt.css" rel="stylesheet" type="text/css" />

    <div id="head">
        <h2>{$dashboardTitle}</h2>
         <button  title="{t}Add an indicator to the dashboard{/t}" href="{$page}" onclick="addDashboardPlugin();return false;">
            <img align="absmiddle" border="0" src="images/b_add.png" alt="Add icon">
            {t}Add{/t}
         </button>
         <button  title="{t}Save dashboard settings{/t}">
            <img align="absmiddle" border="0" src="images/b_save.png" alt="Add icon">
            {t}Save{/t}
         </button>
         <div id="dialogAddDashboardPlugin" title="{t}Add Indicator{/t}" class="ui-helper-hidden">
            <form id="formAddDashboardPlugin" name="formAddDashboardPlugin" method="post" action="{$page}" >
               <fieldset style="width: 500px; margin-top:1em;">
                  <strong>{t}Indicator{/t}:</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  <select class="cbPluginCandidates">
                     <option value="0"></option>
                     {foreach from=$dashboardPluginCandidates key=id item=i}
                     <option value="{$i.pluginClassName}">{$i.title}</option>
                     {/foreach}
                  </select>
                  <p style="margin-top:1em;">
                     <strong>{t}Description{/t}:</strong><br>
                     <hr>
                     <div class="pluginDescription"></div>
                  </p>
                  <p style="margin-top:2em;">
                     <strong>{t}Attributes{/t}:</strong><br>
                     <hr>
                     <div class="pluginAttributes">
                     </div>
                  </p>
                  <input type="hidden" name="action"  value="addDashboardPlugin" />
                  <input type="hidden" name="userid" value="{$userid}" />
               </fieldset>
            </form>
         </div>
      </div>

    </div>
    <div id="columns">

        <ul id="column1" class="column">
           {foreach from=$dashboardWidgets key=id item=i}
            <li class="widget {$i.color}" id="{$i.id}">
                <div class="widget-head">
                    <h3>{$i.title}</h3>
                </div>
                <div class="widget-content">
                   {$i.content}
                </div>
            </li>
           {/foreach}

            <li class="widget color-yellow">
                <div class="widget-head">
                    <h3>Extra Info</h3>
                </div>
                <div class="widget-content">
                    <p>Try clicking the 'X' in the top right of this widget... Just watch how cool the animaton is! :D</p>
                    <ul>
                        <li>Since this is just a demo your settings will NOT be saved anywhere when you leave the page.</li>
                        <li>This demo has been tested successfully on a Windows XP PC in the following browsers: Firefox 2, Firefox 3, Chrome, Safari 3, Opera 9.5, IE6, IE7</li>
                    </ul>
                </div>
            </li>
            <li class="widget color-green">
                <div class="widget-head">
                    <h3>Some Random Title</h3>
                </div>
                <div class="widget-content">
                    <ul>
                        <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam magna sem, fringilla in, commodo a, rutrum ut, massa. Donec id nibh eu dui auctor tempor. Morbi laoreet eleifend dolor. Suspendisse pede odio, accumsan vitae, auctor non, suscipit at, ipsum. Cras varius sapien vel lectus.</li>
                    </ul>
                </div>
            </li>
            <li class="widget color-orange">
                <div class="widget-head">
                    <h3>Some Random Title</h3>
                </div>
                <div class="widget-content">
                    <ul>
                        <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam magna sem, fringilla in, commodo a, rutrum ut, massa. Donec id nibh eu dui auctor tempor. Morbi laoreet eleifend dolor. Suspendisse pede odio, accumsan vitae, auctor non, suscipit at, ipsum. Cras varius sapien vel lectus.</li>
                    </ul>
                </div>
            </li>

        </ul>

    </div>

    <script type="text/javascript" src="lib/inettuts/inettuts_codevtt.js"></script>

    <script type="text/javascript">
      function addDashboardPlugin(){
         //jQuery("#desc_date").text(date);
         //jQuery("#formAddDashboardPlugin").find("input[name=trackid]").val(trackid);

         jQuery("#dialogAddDashboardPlugin").dialog("open");
      }

      jQuery(document).ready(function() {
         
         jQuery("#dialogAddDashboardPlugin").dialog({
            autoOpen: false,
            resizable: true,
            width: "auto",
            modal: true,
            buttons: {
               "Add": function() {
                  jQuery("#formAddDashboardPlugin").submit();
               },
               Cancel: function() {
                  jQuery(this).dialog("close");
               }
            }
         });

         jQuery(".cbPluginCandidates").change(function() {
            console.log(".cbPluginCandidates change " + this.value);
            $.ajax({
               type: "POST",
                 url: 'include/dashboard_ajax.php',
                 data: { pluginClassName: this.value,
                         action: "getIndicatorConfigInfo"
                 },
                 success: function(data) {
                    console.log("getIndicatorConfigInfo: OK: " + data);
                    console.log("description = " + data['description']);
                    console.log("attributesHtml = " + data['attributesHtml']);
                    jQuery('.pluginDescription').html(data['description']);
                 },
                 error:  function() {
                    alert("getIndicatorConfigInfo ERROR!");
                 }
            });
         });

      });
    </script>

</div>
