<div id="content">

<style type="text/css">
  ul.dynatree-container span.td {
     position: absolute;
     display: inline;
     border-size: 1px;
     overflow: hidden;
     background-color: white;
  }
  ul.dynatree-container span.td:nth-child(1) {
     position: static;
  }
  ul.dynatree-container span.td:nth-child(2) {
     left: 300px;
     width: 120px;
  }
  ul.dynatree-container span.td:nth-child(3) {
     left: 450px;
     width: 100px;
  }
  ul.dynatree-container span.td:nth-child(4) {
     left: 550px;
     width: 100px;
  }
  ul.dynatree-container span.td:nth-child(5) {
     left: 650px;
     width: 100px;
  }
  ul.dynatree-container span.td:nth-child(6) {
     left: 750px;
     width: 100px;
  }
  </style>

  <script src="js/progress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
	  function initTree() {
		  $.ajax({
			  type: 'GET',
		      url: 'tests/DataToTree.php',
		      data: 'hasDetail=1',
		      success: function(){
		            $("#tree").dynatree({
		          	    initAjax: {
		                	url: 'tpl/treeDataDetail.json'
		          	    },
		          	    onCustomRender: function(node) {

		                  // Render title as columns
		                  if( (null == node.data.title) ||
		                      (node.data.title.indexOf("~") === -1)) {
		                    // Default rendering
		                    return false;
		                  }
		                  var cols = node.data.title.split("~"),
		                  html = "<a class='dynatree-title' href='#'>";
		                  html += "<span class='td'>" + cols[0] + "</span>";
			              if(cols.length > 1) {
			            	 html += "<span class='td'><div class='progress ui-progressbar ui-widget ui-widget-content ui-corner-all' ";
			            	 html += "role='progressbar' aria-valuemin='0' aria-valuemax='100' aria-valuenow='" + cols[1] + "'>";
			            	 html += "<div class='ui-progressbar-value ui-widget-header ui-corner-left' style='width: " + cols[1] + "%;'>";
			            	 html += "<div>" + cols[1] + "%</div></div></div></span>";
			              }
		                  for(var i=2; i<cols.length; i++){
		                     html += "<span class='td'>" + cols[i] + "</span>";
		                  }
		                  return html + "</a>";
		          	    }

		            });
		            
		          },
		          error:  function() {
		        	  alert("WBS Load ERROR!");
		       	  }

		      });
	  }
	  window.onload = initTree;
  </script>

   <h1>WBS Display</h1>

   <a id="bt_loadTree" style="text-decoration: none" href="{$page}"><img align="absmiddle" src="images/b_refresh.png" style="vertical-align: middle;" title="{t}Load{/t}"> Load</a>
   <div id="tree">
   </div>

</div>

   <script type="text/javascript">
   jQuery(document).ready(function() {
       jQuery("#bt_loadTree").click(function(event) {
          event.preventDefault();
          $("#tree").dynatree("destroy");
          initTree();
       });
    });
   </script>