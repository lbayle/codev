{include file="form/projectFilterDialogbox.html"}


{if isset($overviewTotal) || isset($detailedMgrTotal) || isset($detailedTotal) || isset($issuesTotal)}
<h3>{t}Detailed Charges{/t}</h3>


<div class="center">
   <form name="selectFiltersForm" id="selectFiltersForm" class = "formWithTabsHistory" method="get" action="{$page}">
      <fieldset>
         <label for="selectFilters">{t}Add filters{/t}: </label>
         <a title="{t}Set filters{/t}" id="selectFilters" style="text-decoration: none" href="{$page}">
            <img border="0" width="16" height="12" align="absmiddle" src="images/{if isset($selectedFilters) && $selectedFilters != ""}im-filter-active.png{else}im-filter.png{/if}" alt="{t}Set project filters{/t}" />
         </a>
         <input type="hidden" name="selectedFilters" value="{$selectedFilters}" />
         <input type="submit" value="{t}Apply{/t}" />
      </fieldset>
   </form>
</div>


<script src="js/tabs.js" type="text/javascript"></script>
<div id="tabsDetailedCharges" class="tabs">
   <ul>
      <li><a href="#tabOverviewCharges">{t}Overview{/t}</a></li>
      {if $isManager}<li><a href="#tabDetailedCharges">{t}Detailed{/t}</a></li>{/if}
      <li><a href="#tabChargesIssues">{t}Tasks{/t}</a></li>
   </ul>
   <div id="tabOverviewCharges">
      {assign var=filterResultsTitles value=$overviewTitles}
      {assign var=filterResultsLines value=$overviewLines}
      {assign var=filterResultsTotal value=$overviewTotal}
      {if isset($filterResultsTotal)}
      <table>
         <thead>
            {if 0 == $nbFilters}
            <th></th>
            {/if}
            {foreach from=$filterResultsTitles key=id item=ftitle}
            <th style="width: 9em;">{$ftitle}</th>
            {/foreach}
         </thead>
         <tbody>
            {foreach from=$filterResultsLines key=id item=line}
            <tr>
               {for $idx=1 to $nbFilters}
               <td nowrap="nowrap">{$line[$idx]}</td>
               {/for}
               <!--<td>{$line[$nbFilters+1].date}</td>-->
               <td><div class="progress">{$line[$nbFilters+1].progress}%</div></td>
               {if $isManager}<td>{$line[$nbFilters+1].reestimated}</td>{/if}
               <td>{$line[$nbFilters+1].backlog}</td>
               {if $isManager}<td {if $line[$nbFilters+1].driftMgrColor}style='background-color: #{$line[$nbFilters+1].driftMgrColor};'{/if} title="{t}nb days{/t}">{$line[$nbFilters+1].driftMgr}%</td>{/if}
               <td {if $line[$nbFilters+1].driftColor}style='background-color: #{$line[$nbFilters+1].driftColor};'{/if} title="{t}nb days{/t}">{$line[$nbFilters+1].drift}%</td>
            </tr>
            {/foreach}
         </tbody>
         <tfoot>
            <tr>
               <td>TOTAL</td>
               {for $idx=1 to ($nbFilters-1)}
               <td></td>
               {/for}
               <!--<td>{$filterResultsTotal[$nbFilters+1].date}</td>-->
               <td><div class="progress">{$filterResultsTotal[$nbFilters+1].progress}%</div></td>
               {if $isManager}<td>{$filterResultsTotal[$nbFilters+1].reestimated}</td>{/if}
               <td>{$filterResultsTotal[$nbFilters+1].backlog}</td>
               {if $isManager}<td {if $filterResultsTotal[$nbFilters+1].driftMgrColor}style='background-color: #{$filterResultsTotal[$nbFilters+1].driftMgrColor};'{/if} title="{t}nb days{/t}">{$filterResultsTotal[$nbFilters+1].driftMgr}%</td>{/if}
               <td {if $filterResultsTotal[$nbFilters+1].driftColor}style='background-color: #{$filterResultsTotal[$nbFilters+1].driftColor};'{/if} title="{t}nb days{/t}">{$filterResultsTotal[$nbFilters+1].drift}%</td>
            </tr>
         </tfoot>
      </table>
      {else}
      {t}No data{/t}
      {/if}
   </div>
   {if $isManager}
   <div id="tabDetailedCharges">
      {assign var=filterResultsTitles value=$detailedMgrTitles}
      {assign var=filterResultsLines value=$detailedMgrLines}
      {assign var=filterResultsTotal value=$detailedMgrTotal}
      {if isset($filterResultsTotal)}
      <table>
         <thead>
            {if 0 == $nbFilters}
            <th></th>
            {/if}
            {foreach from=$filterResultsTitles key=id item=ftitle}
            <th style="width: 9em;">{$ftitle}</th>
            {/foreach}
         </thead>
         <tbody>
            {foreach from=$filterResultsLines key=id item=line}
            <tr>
               {for $idx=1 to $nbFilters}
               <td nowrap="nowrap">{$line[$idx]}</td>
               {/for}
               <td><div class="progress">{$line[$nbFilters+1].progress}%</div></td>
               <td>{$line[$nbFilters+1].effortEstimMgr}</td>
               <td>{$line[$nbFilters+1].effortEstim}</td>
               <td>{$line[$nbFilters+1].reestimated}</td>
               <td>{$line[$nbFilters+1].elapsed}</td>
               <td>{$line[$nbFilters+1].backlog}</td>
               <td {if $line[$nbFilters+1].driftColorMgr}style='background-color: #{$line[$nbFilters+1].driftColorMgr};'{/if} title="{t}nb days{/t}">{$line[$nbFilters+1].driftMgr}</td>
               <td {if $line[$nbFilters+1].driftColor}style='background-color: #{$line[$nbFilters+1].driftColor};'{/if} title="{t}nb days{/t}">{$line[$nbFilters+1].drift}</td>
            </tr>
            {/foreach}
         </tbody>
         <tfoot>
            <tr>
               <td>TOTAL</td>
               {for $idx=1 to ($nbFilters-1)}
               <td></td>
               {/for}
               <td><div class="progress">{$filterResultsTotal[$nbFilters+1].progress}%</div></td>
               <td>{$filterResultsTotal[$nbFilters+1].effortEstimMgr}</td>
               <td>{$filterResultsTotal[$nbFilters+1].effortEstim}</td>
               <td>{$filterResultsTotal[$nbFilters+1].reestimated}</td>
               <td>{$filterResultsTotal[$nbFilters+1].elapsed}</td>
               <td>{$filterResultsTotal[$nbFilters+1].backlog}</td>
               <td {if $filterResultsTotal[$nbFilters+1].driftColorMgr}style='background-color: #{$filterResultsTotal[$nbFilters+1].driftColorMgr};'{/if} title="{t}nb days{/t}">{$filterResultsTotal[$nbFilters+1].driftMgr}</td>
               <td {if $filterResultsTotal[$nbFilters+1].driftColor}style='background-color: #{$filterResultsTotal[$nbFilters+1].driftColor};'{/if} title="{t}nb days{/t}">{$filterResultsTotal[$nbFilters+1].drift}</td>
            <tr>
         </tfoot>
      </table>
      {else}
      {t}No data{/t}
      {/if}
   </div>
   {/if}
   <div id="tabChargesIssues">
      {assign var=filterResultsTitles value=$issuesTitles}
      {assign var=filterResultsLines value=$issuesLines}
      {assign var=filterResultsTotal value=$issuesTotal}
      {if isset($filterResultsTotal)}
      <table>
         <thead>
            {if 0 == $nbFilters}
            <th></th>
            {/if}
            {foreach from=$filterResultsTitles key=id item=ftitle}
            <th>{$ftitle}</th>
            {/foreach}
         </thead>
         <tbody>
            {foreach from=$filterResultsLines key=id item=line}
            <tr>
               {for $idx=1 to $nbFilters}
               <td nowrap="nowrap">{$line[$idx]}</td>
               {/for}
               <td>{$line[$nbFilters+1].newList}</td>
               <td>{$line[$nbFilters+1].openList}</td>
               <td>{$line[$nbFilters+1].resolvedList}</td>
            </tr>
            {/foreach}
         </tbody>
      </table>
      {else}
      {t}No data{/t}
      {/if}
   </div>
</div>
{/if}
