<script type="text/javascript">
   jQuery(document).ready(function() {
      jQuery(".dayTask").click(function() {
         var day = jQuery(this);
         if(day.text() != '') {
            jQuery("body").css('cursor','wait');

            var row = day.parent();
            var jobid = row.find("td[class^=job]").attr("class").replace("job-","");
            if(jQuery("#job option[value="+jobid+"]").val() != null) {
               jQuery("#job").val(jobid);
            } else if("#job") {
               jQuery("#job").append($('<option>', { value : jobid, selected : 'selected' }));
            }
            jQuery("#job").val(jobid);
            // Don't set the duration
            //jQuery("#duree").val(day.text());

            var bugid = row.attr("id").replace("weekTasks-","");
            if(jQuery("#bugid option[value="+bugid+"]").val() != null) {
               jQuery("#bugid").val(bugid);
            } else {
               jQuery("#bugid").append($('<option>', { value : bugid, selected : 'selected' }));
            }

            var form1 = jQuery("#form1");
            form1.find("input[name=action]").val("setBugId");

            // Keep value of Week form
            form1.find("input[name=weekid]").val(jQuery("#weekid").val());
            form1.find("input[name=year]").val(jQuery("#year").val());

            form1.submit();
         }
      });
   });
</script>
<table id="weekTaskDetails">
   <tr>
      <th>{t}Task{/t}</th>
      <th>{t}RAF{/t}</th>
      <th>{t}Job{/t}</th>
      {foreach from=$weekDates key=id item=i}
      <th width="80" id="date-{$id}">{$i}</th>
      {/foreach}
      {foreach from=$weekEndDates item=i}
      <th width="80" style="background-color: #D8D8D8;">{$i}</th>
      {/foreach}
   </tr>
   {foreach from=$weekTasks key=id item=i}
   <tr id="weekTasks-{$i.bugid}">
      <td>{$i.mantisURL} {$i.issueURL} / {$i.issueId} : {$i.summary}</td>
      <td><a title="{t}update remaining{/t}" onclick="updateRemaining('{$i.remaining}',
            '{$i.description}', '{$i.bugid}', '{$i.dialogBoxTitle}');return false;" href="#">{$i.formattedRemaining}</a>
      </td>
      <td class="job-{$i.jobid}">{$i.jobName}</td>
      {foreach from=$i.dayTasks key=day item=j}
      <td {$j.bgColor} {$j.title} class="dayTask">{$j.day}</td>
      {/foreach}
   </tr>
   {/foreach}
</table>
