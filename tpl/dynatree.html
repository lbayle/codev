<div id="content">


  <script type="text/javascript">
    $(function(){
      $("#tree").dynatree({
        // using default options
      });
    });
  </script>

   <h1>Example: Default</h1>
  <a id="bt_saveTree" style="text-decoration: none" href="{$page}"><img align="absmiddle" src="images/b_save.png" style="vertical-align: middle;" title="{t}Save{/t}"> Save</a>

  <div id="tree">
    <ul id="treeData" style="display: none;">
      <li id="m1600">1600 a mantis task
      <li id="m1632">1632 another mantis task
      <li id="wbse1" class="folder expanded">WBS
        <ul>
          <li id="m1655">1655 check dynatree library
          <li id="m1656">1656 define WbsElement class
          <li id="m1657">1657 define WbsElement in DB
        </ul>
      <li id="wbse2" class="folder expanded">Dashboard
        <ul>
          <li id="wbse3"  class="folder">Dashboard Homepage
            <ul>
              <li id="m1700">1700 add dashboard
              <li id="m1701">1701 add basic indicators
            </ul>
          <li id="wbse4" class="folder">Dashboard Items
            <ul>
              <li id="m1702">1702 convert all indicators to dashboard items
              <li id="m1703">1703 include filters in dashboard items
            </ul>
        </ul>
    </ul>
  </div>


   <script type="text/javascript">

      jQuery(document).ready(function() {
         jQuery("#bt_saveTree").click(function(event) {
            event.preventDefault();

            var dict = $("#tree").dynatree("getTree").toDict();
            var jsonDict = JSON.stringify(dict);
            var formSaveWBS = jQuery("#formSaveWBS");
            formSaveWBS.find("input[name=jsonDynatreeDict]").val(jsonDict);

            jQuery.ajax({
               type: "GET",
               url: formSaveWBS.attr("action"),
               data: formSaveWBS.serialize(),
               success: function(data) {
                  alert("WBS Saved: " + data);
               },
               error:  function(data) {
                  alert("WBS ERROR: " + data);
               }
            });
         });

      });
   </script>

   <form id="formSaveWBS" name="formSaveWBS" method="get" action="tests/dynatree_ajax.php" >
      <fieldset>
         <input type="hidden" name="action" value="saveWBS" />
         <input type="hidden" name="jsonDynatreeDict" value="" />
      </fieldset>
   </form>

</div>
