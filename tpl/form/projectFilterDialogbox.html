<style>
   .sortable { list-style-type: none; margin: 0; padding: 0; margin-right: 10px; background: #eee; padding: 5px; width: 173px;}
   .sortable li { margin: 5px; padding: 5px; font-size: 1.2em; width: 150px; }
   .sortable li:hover { cursor: pointer; }
   .sortable li { cursor: move; }
</style>

<script type="text/javascript">
   jQuery(document).ready(function() {

      jQuery("#projectFilters").click(function(event) {
         event.preventDefault();
         jQuery("#set_projectfilter_dialog").dialog("open");
      });

      jQuery("#set_projectfilter_dialog").dialog({
         autoOpen: false,
         height: 'auto',
         width: 450,
         modal: true,
         buttons: {
            Ok: function() {
               var filters = '';
               jQuery(this).find('#sortableTarget').children().each(function() {
                  filters += jQuery(this).attr('id') + ',';
               });
               var form = jQuery("#projectForm");
               form.find("input[name=selectedFilters]").val(filters);
               if(filters.length != 0) {
                  form.find("#projectFilters img").attr("src","images/im-filter-active.png");
                  form.submit();
               } else {
                  form.find("#projectFilters img").attr("src","images/im-filter.png");
               }
               jQuery(this).dialog("close");
            },
            Cancel: function() {
               jQuery(this).dialog("close");
            }
         }
      });
      
      jQuery("ul.droptrue").sortable({
         connectWith: "ul"
      });
      
      jQuery("ul.dropfalse").sortable({
         connectWith: "ul",
         dropOnEmpty: false
      });
      
      jQuery(".sortable").disableSelection();
});

</script>

<div id="set_projectfilter_dialog" title="{t}Task Filters{/t}" class="ui-helper-hidden">
   <p id="setfilter_desc">{t}Drag & drop the filters to apply{/t}</p>
   <br />
   <form id="formSetProjectFilters" name="formSetProjectFilters" method="post" action="{$page}" >
      <fieldset>
         <div style="float:left;">
            <label for="sortableSource"><b>{t}Available Filters{/t}</b></label>
            <ul id="sortableSource" class="sortable droptrue" style="height:{math equation="(x + y) * 37" x=$availFilterList|count y=$selectedFilterList|count}px">
               {foreach from=$availFilterList key=id item=fname}
               <li class="ui-state-default" id="{$id}" >{$fname}</li>
               {/foreach}
            </ul>
         </div>

         <div style="float:left;">
            <label for="sortableTarget"><b>{t}Applyed Filters{/t}</b></label>
            <ul id="sortableTarget" class="sortable droptrue" style="height:{math equation="(x +y) * 37" x=$availFilterList|count y=$selectedFilterList|count}px">
               {foreach from=$selectedFilterList key=id item=fname}
               <li class="ui-state-default" id="{$id}" >{$fname}</li>
               {/foreach}
            </ul>
         </div>
         <input type="hidden" name="userid" value="{$userid}" />
         <input type="hidden" name="projectid" value="{$projectid}" />
         <input type="hidden" name="action" value="setFiltersAction" />
      </fieldset>
   </form>
</div>
